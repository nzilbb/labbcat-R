<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Appends measurements from Praat to a dataframe of matches. — appendFromPraat • nzilbb.labbcat</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Appends measurements from Praat to a dataframe of matches. — appendFromPraat"><meta name="description" content="This is a version of processWithPraat that can have a dataframe of matches piped into
it, and returns the dataframe with columns appended."><meta property="og:description" content="This is a version of processWithPraat that can have a dataframe of matches piped into
it, and returns the dataframe with columns appended."><meta property="og:image" content="https://nzilbb.github.io/labbcat-R/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@labbcat"><meta name="twitter:site" content="@labbcat"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nzilbb.labbcat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples/search-labels-alignments-praat-script.html">Search, Annotation, and Praat Script Example</a></li>
    <li><a class="dropdown-item" href="../articles/examples/search-labels-alignments-r-script.html">Search, Annotation, and R Script Example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nzilbb/labbcat-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Appends measurements from Praat to a dataframe of matches.</h1>
      <small class="dont-index">Source: <a href="https://github.com/nzilbb/labbcat-R/blob/HEAD/R/appendFromPraat.R" class="external-link"><code>R/appendFromPraat.R</code></a></small>
      <div class="d-none name"><code>appendFromPraat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a version of <a href="processWithPraat.html">processWithPraat</a> that can have a dataframe of matches piped into
it, and returns the dataframe with columns appended.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">appendFromPraat</span><span class="op">(</span></span>
<span>  <span class="va">matches</span>,</span>
<span>  <span class="va">start.column</span>,</span>
<span>  <span class="va">end.column</span>,</span>
<span>  <span class="va">praat.script</span>,</span>
<span>  <span class="va">window.offset</span>,</span>
<span>  gender.attribute <span class="op">=</span> <span class="st">"participant_gender"</span>,</span>
<span>  attributes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  no.progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  labbcat.url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column.prefix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matches">matches<a class="anchor" aria-label="anchor" href="#arg-matches"></a></dt>
<dd><p>A dataframe returned by <a href="getMatches.html">getMatches</a> or <a href="getAllUtterances.html">getAllUtterances</a>, identifying
the results to which acoustic measurments should be appended.</p></dd>


<dt id="arg-start-column">start.column<a class="anchor" aria-label="anchor" href="#arg-start-column"></a></dt>
<dd><p>The column of <code>matches</code> containing the start time in seconds.</p></dd>


<dt id="arg-end-column">end.column<a class="anchor" aria-label="anchor" href="#arg-end-column"></a></dt>
<dd><p>The column of <code>matches</code> containing the end time in seconds.</p></dd>


<dt id="arg-praat-script">praat.script<a class="anchor" aria-label="anchor" href="#arg-praat-script"></a></dt>
<dd><p>Script to run on each match. This may be a single string or a
character vector.</p></dd>


<dt id="arg-window-offset">window.offset<a class="anchor" aria-label="anchor" href="#arg-window-offset"></a></dt>
<dd><p>In many circumstances, you will want some context before and after
the sample start/end time.  For this reason, you can specify a "window offset" -
this is a number of seconds to subtract from the sample start and add to the sample
end time, before extracting that part of the audio for processing. For example, if
the sample starts at 2.0s and ends at 3.0s, and you set the window offset to 0.5s,
then Praat will extract a sample of audio from  1.5s to 3.5s, and do the selected
processing on that sample. The best value for this depends on what the praat.script
is doing; if you are getting formants from  vowels, including some context ensures
that the formants at the edges are more accurate (in LaBB-CAT's web interface, the
default value for this 0.025), but if you're getting max pitch or COG during a
segment, most likely you want a window.offset of 0 to ensure neighbouring segments
don't influence the measurement.</p></dd>


<dt id="arg-gender-attribute">gender.attribute<a class="anchor" aria-label="anchor" href="#arg-gender-attribute"></a></dt>
<dd><p>Which participant attribute represents the participant's gender.</p></dd>


<dt id="arg-attributes">attributes<a class="anchor" aria-label="anchor" href="#arg-attributes"></a></dt>
<dd><p>Vector of participant attributes to make available to the script. For
example, if you want to use different acoustic parameters depending on what the
gender of the speaker is, including the "participant_gender" attribute will make a
variable called participant_gender$ available to the praat script, whose value will
be the gender of the speaker of that segment.</p></dd>


<dt id="arg-no-progress">no.progress<a class="anchor" aria-label="anchor" href="#arg-no-progress"></a></dt>
<dd><p>TRUE to suppress visual progress bar. Otherwise, progress bar will be
shown when interactive().</p></dd>


<dt id="arg-labbcat-url">labbcat.url<a class="anchor" aria-label="anchor" href="#arg-labbcat-url"></a></dt>
<dd><p>URL to the LaBB-CAT instance (instead of inferring it from <code>matches</code>).</p></dd>


<dt id="arg-column-prefix">column.prefix<a class="anchor" aria-label="anchor" href="#arg-column-prefix"></a></dt>
<dd><p>A string to prefix each new column name with.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>matches</code> with the acoustic measurements appended as new columns.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It instructs the LaBB-CAT server to invoke Praat for a set of sound
intervals, in order to extract acoustic measures.</p>
<p>The exact measurements to return depend on the praat.script that is invoked. This is a
Praat script fragment that will run once for each sound interval specified.</p>
<p>There are functions to allow the generation of a number of pre-defined praat scripts
for common tasks such as formant, pitch, intensity, and centre of gravity – see
<a href="praatScriptFormants.html">praatScriptFormants</a>, <a href="praatScriptCentreOfGravity.html">praatScriptCentreOfGravity</a>, <a href="praatScriptIntensity.html">praatScriptIntensity</a>
and <a href="praatScriptPitch.html">praatScriptPitch</a>.</p>
<p>You can provide your own script, either by building a string with your code, or loading
one from a file.</p>
<p>LaBB-CAT prefixes praat.script with code to open a sound file and extract a defined part
of it into a Sound object which is then selected.</p>
<p>LaBB-CAT <code>Remove's this Sound object after the script finishes executing. Any other objects created by the script must be </code>Remove'd before the end of the script (otherwise Praat runs out
of memory during very large batches)</p>
<p>LaBB-CAT assumes that all calls to the function 'print' correspond to fields for export
and each field must be printed on its own line. Specifically it scans for lines of the
form:</p>
<p>print 'myOutputVariable' 'newline$'</p>
<p>Variables that can be assumed to be already set in the context of the script are:</p><ul><li><p><em>windowOffset</em>
– the value used for the Window Offset; how much context to include.</p></li>
<li><p><em>windowAbsoluteStart</em>
– the start time of the window extracted relative to the start of the original audio file.</p></li>
<li><p><em>windowAbsoluteEnd</em>
– the end time of the window extracted relative to the start of the original audio file.</p></li>
<li><p><em>windowDuration</em>
– the duration of the window extracted (including window offset).</p></li>
<li><p><em>targetAbsoluteStart</em>
– the start time of the target interval relative to the start of the original audio file.</p></li>
<li><p><em>targetAbsoluteEnd</em>
– the end time of the target interval relative to the start of the original audio file.</p></li>
<li><p><em>targetStart</em>
– the start time of the target interval relative to the start of the window extracted.</p></li>
<li><p><em>targetEnd</em>
– the end time of the target interval relative to the start of the window extracted.</p></li>
<li><p><em>targetDuration</em>
– the duration of the target interval.</p></li>
<li><p><em>sampleNumber</em>
– the number of the sample within the set of samples being processed.</p></li>
<li><p><em>sampleName$</em>
– the name of the extracted/selected Sound object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><a href="processWithPraat.html">processWithPraat</a></p></li>
<li><p><a href="getMatches.html">getMatches</a></p></li>
</ul><p>Other Praat-related functions:
<code><a href="fragmentLabels.html">fragmentLabels</a>()</code>,
<code><a href="fragmentTranscripts.html">fragmentTranscripts</a>()</code>,
<code><a href="praatScriptCentreOfGravity.html">praatScriptCentreOfGravity</a>()</code>,
<code><a href="praatScriptFastTrack.html">praatScriptFastTrack</a>()</code>,
<code><a href="praatScriptFormants.html">praatScriptFormants</a>()</code>,
<code><a href="praatScriptIntensity.html">praatScriptIntensity</a>()</code>,
<code><a href="praatScriptPitch.html">praatScriptPitch</a>()</code>,
<code><a href="processWithPraat.html">processWithPraat</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Get all tokens of /I/</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMatches.html">getMatches</a></span><span class="op">(</span><span class="va">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>segment<span class="op">=</span><span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">appendFromPraat</span><span class="op">(</span> <span class="co">## get F1 and F2 for the mid point of the vowel</span></span></span>
<span class="r-in"><span>       <span class="va">Target.segment.start</span>, <span class="va">Target.segment.end</span>, <span class="co"># for the vowel</span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="praatScriptFormants.html">praatScriptFormants</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       window.offset<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="co">## get F1 and F2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get all tokens of /i:/</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMatches.html">getMatches</a></span><span class="op">(</span><span class="va">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>segment<span class="op">=</span><span class="st">"i"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>   <span class="fu">appendFromPraat</span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="va">Target.segment.start</span>, <span class="va">Target.segment.end</span>, <span class="co">## for the target vowel...</span></span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>           <span class="co">## ... get first 3 formants at three points during the sample ...</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="praatScriptFormants.html">praatScriptFormants</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="co">## ... the mean, min, and max pitch ...</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="praatScriptPitch.html">praatScriptPitch</a></span><span class="op">(</span>get.mean<span class="op">=</span><span class="cn">TRUE</span>, get.minimum<span class="op">=</span><span class="cn">TRUE</span>, get.maximum<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="co">## ... the max intensity ...</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="praatScriptIntensity.html">praatScriptIntensity</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="co">## ... and the CoG using powers 1 and 2 </span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="praatScriptCentreOfGravity.html">praatScriptCentreOfGravity</a></span><span class="op">(</span>powers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">2.0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       window.offset<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get all tokens of /s/</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMatches.html">getMatches</a></span><span class="op">(</span><span class="va">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>segment<span class="op">=</span><span class="st">"s"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>   <span class="fu">appendFromPraat</span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="va">Target.segment.start</span>, <span class="va">Target.segment.end</span>,</span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"acousticMeasurements.praat"</span><span class="op">)</span><span class="op">)</span> <span class="co">## execute a custom script loaded form a file</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><style type="text/css">
  footer img {
      vertical-align: middle;
      height: 40px;
      display: inline-block;
  }
</style><small><a rel="license" href="http://creativecommons.org/licenses/by-sa/2.0/" class="external-link"><img alt="CC-BY-SA Creative Commons Licence " src="https://nzilbb.github.io/labbcat-R/cc-by-sa.svg" title="This work is licensed under a Creative Commons Attribution-ShareAlike 2.0 Generic License"></a><a rel="author" href="https://www.canterbury.ac.nz/nzilbb/" class="external-link"><img src="https://nzilbb.github.io/labbcat-R/nzilbb.svg" alt="Te Kāhui Roro Reo | The New Zealand Institute of Language, Brain and Behaviour" title="🄯 2021 NZILBB"></a></small>

    </footer></div>





  </body></html>

